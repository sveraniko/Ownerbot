# OwnerBot Templates V2 (Business-in-Pocket)

> –¶–µ–ª—å: –¥–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü—É –±–∏–∑–Ω–µ—Å–∞ **–∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–π –Ω–∞–±–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤** (–∫–Ω–æ–ø–∫–∏ + –≥–æ–ª–æ—Å/—Ç–µ–∫—Å—Ç), –≥–¥–µ –∫–∞–∂–¥—ã–π —à–∞–±–ª–æ–Ω ‚Äî —ç—Ç–æ *–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –±–∏–∑–Ω–µ—Å‚Äë–æ–ø–µ—Ä–∞—Ü–∏—è*: –∑–∞–ø—Ä–æ—Å ‚Üí –ø–ª–∞–Ω ‚Üí tool-calls ‚Üí (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) confirm ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç–µ–∫—Å—Ç/–≥—Ä–∞—Ñ–∏–∫/PDF) ‚Üí –∞—É–¥–∏—Ç.

## –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–®–∞–±–ª–æ–Ω = –ø—Ä–æ–¥—É–∫—Ç–æ–≤–∞—è –µ–¥–∏–Ω–∏—Ü–∞**

* `id`, `title`, `category`, `intent_aliases`, `prompt`, `tools_plan`, `confirm_policy`, `output_renderer`.

2. **–ö–Ω–æ–ø–∫–∏ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç**

* –ö–Ω–æ–ø–∫–∏ = –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∞–º—ã–º —á–∞—Å—Ç—ã–º –∑–∞–¥–∞—á–∞–º.
* –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≥–æ–ª–æ—Å–æ–º/—Ç–µ–∫—Å—Ç–æ–º —á–µ—Ä–µ–∑ —Ç–µ –∂–µ —à–∞–±–ª–æ–Ω—ã.

3. **No-spam –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**

* –õ—é–±–æ–π —à–∞–±–ª–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ (—Ü–µ–Ω—ã, —Å–∫–∏–¥–∫–∏, –º–∞—Å—Å–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è) ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `dry_run ‚Üí confirm ‚Üí commit`.
* –ï—Å–ª–∏ `dry_run` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `noop/skipped` ‚Äî **confirm –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º**.

4. **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (PNG/PDF) ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞**

* –ì—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏ (PNG)
* –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç (PDF)

---

## –ú–µ–Ω—é (–≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å)

1. üìä **–û—Ç—á—ë—Ç—ã**
2. üßæ **–ó–∞–∫–∞–∑—ã**
3. üí∏ **–¶–µ–Ω—ã (FX)**
4. üè∑Ô∏è **–°–∫–∏–¥–∫–∏**
5. üì¶ **–¢–æ–≤–∞—Ä—ã**
6. üë• **–ö–æ–º–∞–Ω–¥–∞**
7. ‚öôÔ∏è **–°–∏—Å—Ç–µ–º—ã**
8. üîß **Advanced**
9. üîî **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** *(–º–æ–∂–µ—Ç –±—ã—Ç—å –≤–ª–æ–∂–µ–Ω–æ –≤ ¬´–°–∏—Å—Ç–µ–º—ã¬ª, –Ω–æ –ª—É—á—à–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–æ–º, —á—Ç–æ–±—ã –≤–ª–∞–¥–µ–ª–µ—Ü –Ω–µ –∏—Å–∫–∞–ª)*

> –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞: 4‚Äì8 –∫–Ω–æ–ø–æ–∫. –û—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî —á–µ—Ä–µ–∑ ¬´–ï—â—ë‚Ä¶¬ª –∏/–∏–ª–∏ –≥–æ–ª–æ—Å.

---

# –ö–∞—Ç–∞–ª–æ–≥ —à–∞–±–ª–æ–Ω–æ–≤

–ù–∏–∂–µ **–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫**. –ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç ‚Äî —ç—Ç–æ —à–∞–±–ª–æ–Ω.

–§–æ—Ä–º–∞—Ç:

* **ID** ‚Äî –ù–∞–∑–≤–∞–Ω–∏–µ

  * –ß—Ç–æ –¥–µ–ª–∞–µ—Ç
  * –í—ã–≤–æ–¥
  * Tools (–ø—Ä–∏–º–µ—Ä)
  * Confirm: –¥–∞/–Ω–µ—Ç

---

## üìä –û—Ç—á—ë—Ç—ã

### –ë–∞–∑–æ–≤—ã–µ KPI

* **RPT_KPI_TODAY** ‚Äî KPI –∑–∞ —Å–µ–≥–æ–¥–Ω—è
* **RPT_KPI_YESTERDAY** ‚Äî KPI –∑–∞ –≤—á–µ—Ä–∞
* **RPT_KPI_7D** ‚Äî KPI –∑–∞ 7 –¥–Ω–µ–π
* **RPT_KPI_30D** ‚Äî KPI –∑–∞ 30 –¥–Ω–µ–π

  * –í—ã–≤–æ–¥: –≤—ã—Ä—É—á–∫–∞, –∑–∞–∫–∞–∑—ã, –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ, AOV, –∫–æ–Ω–≤–µ—Ä—Å–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å), –≤–æ–∑–≤—Ä–∞—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
  * Tools: `kpi_snapshot(range=...)`
  * Confirm: –Ω–µ—Ç

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤

* **RPT_COMPARE_WOW** ‚Äî –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ–¥–µ–ª—è –∫ –Ω–µ–¥–µ–ª–µ (WoW)
* **RPT_COMPARE_MOM** ‚Äî –ú–µ—Å—è—Ü –∫ –º–µ—Å—è—Ü—É (MoM)
* **RPT_COMPARE_CUSTOM** ‚Äî –°—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ –ø–µ—Ä–∏–æ–¥–∞ (–≤–≤–æ–¥ –¥–∞—Ç)

  * –í—ã–≤–æ–¥: Œî –≤—ã—Ä—É—á–∫–∏/–∑–∞–∫–∞–∑–æ–≤/AOV, —Ç–æ–ø –ø—Ä–∏—á–∏–Ω –∏–∑–º–µ–Ω–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å –º–µ—Ç–∫–∏)
  * Tools: `kpi_compare(preset=wow|mom|custom)`
  * Confirm: –Ω–µ—Ç

### –í—ã—Ä—É—á–∫–∞ –∏ —Ç—Ä–µ–Ω–¥—ã

* **RPT_REVENUE_TREND_30D** ‚Äî –¢—Ä–µ–Ω–¥ –≤—ã—Ä—É—á–∫–∏ 30 –¥–Ω–µ–π (—Ç–µ–∫—Å—Ç)
* **RPT_REVENUE_TREND_30D_PNG** ‚Äî –¢—Ä–µ–Ω–¥ –≤—ã—Ä—É—á–∫–∏ 30 –¥–Ω–µ–π (–≥—Ä–∞—Ñ–∏–∫ PNG)
* **RPT_REVENUE_TREND_90D_PNG** ‚Äî –¢—Ä–µ–Ω–¥ –≤—ã—Ä—É—á–∫–∏ 90 –¥–Ω–µ–π (–≥—Ä–∞—Ñ–∏–∫ PNG)

  * Tools: `revenue_trend(range=...)` + `render_chart_png(...)`
  * Confirm: –Ω–µ—Ç

### –¢–æ–ø—ã

* **RPT_TOP_PRODUCTS_7D** ‚Äî –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ 7 –¥–Ω–µ–π
* **RPT_BOTTOM_PRODUCTS_7D** ‚Äî –ê–Ω—Ç–∏‚Äë—Ç–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞ 7 –¥–Ω–µ–π
* **RPT_TOP_CATEGORIES_30D** ‚Äî –¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π

  * Tools: `top_products(group_by=category, metric=revenue)`
  * Confirm: –Ω–µ—Ç

### –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç—ã

* **RPT_STUCK_ORDERS_SUMMARY** ‚Äî –°–≤–æ–¥–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–∫–∞–∑–æ–≤
* **RPT_UNANSWERED_CHATS_SUMMARY** ‚Äî –°–≤–æ–¥–∫–∞ —á–∞—Ç–æ–≤ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞

  * Tools: `orders_stuck`, `chats_unanswered(threshold=...)`, `team_queue_summary`
  * Confirm: –Ω–µ—Ç

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π PDF (–≤–ª–∞–¥–µ–ª—å—á–µ—Å–∫–∏–π)

* **RPT_WEEKLY_PDF** ‚Äî –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç PDF

  * –°–æ–¥–µ—Ä–∂–∏–º–æ–µ: KPI, —Ç—Ä–µ–Ω–¥, —Ç–æ–ø/–∞–Ω—Ç–∏‚Äë—Ç–æ–ø, –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–æ–Ω—ã
  * Tools: `kpi_snapshot`, `revenue_trend`, `orders_stuck`, `chats_unanswered`, `build_weekly_pdf`
  * Confirm: –Ω–µ—Ç

### üìé Dashboard (on-demand)

* **BIZ_DASHBOARD_DAILY_PNG** ‚Äî Daily dashboard (PNG)
* **BIZ_DASHBOARD_DAILY_TEXT** ‚Äî Daily dashboard (Text)
* **BIZ_DASHBOARD_WEEKLY_PDF** ‚Äî Weekly dashboard (PDF)
* **BIZ_OPS_DASHBOARD_PDF** ‚Äî Ops report (PDF)

  * Tools: `biz_dashboard_daily`, `biz_dashboard_weekly`, `biz_dashboard_ops` (reuse DigestBuilder/ops snapshot + renderers)
  * Safety: Redis lock + cooldown anti-spam
  * Confirm: –Ω–µ—Ç

---

## üßæ –ó–∞–∫–∞–∑—ã

### –ü–æ–∏—Å–∫ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

* **ORD_FIND_BY_ID** ‚Äî –ù–∞–π—Ç–∏ –∑–∞–∫–∞–∑ –ø–æ –Ω–æ–º–µ—Ä—É
* **ORD_FIND_BY_PHONE** ‚Äî –ù–∞–π—Ç–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –∫–ª–∏–µ–Ω—Ç–∞
* **ORD_FIND_BY_STATUS** ‚Äî –ù–∞–π—Ç–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É
* **ORD_FIND_RECENT** ‚Äî –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–∫–∞–∑–æ–≤

  * Tools: `orders_search(filters=...)`, `order_detail(order_id)`
  * Confirm: –Ω–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ

* **ORD_STUCK_LIST** ‚Äî –ó–∞–≤–∏—Å—à–∏–µ –∑–∞–∫–∞–∑—ã (—Å–ø–∏—Å–æ–∫)
* **ORD_LATE_SHIP** ‚Äî –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
* **ORD_PAYMENT_ISSUES** ‚Äî –ü—Ä–æ–±–ª–µ–º—ã –æ–ø–ª–∞—Ç—ã

  * Tools: `orders_search` —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏
  * Confirm: –Ω–µ—Ç

### –°–µ–º–∞–Ω—Ç–∏–∫–∞ `orders_search` (payload)

`orders_search` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–ª—é—á–∏:
- `q?: str` ‚Äî –ø–æ–∏—Å–∫ –ø–æ–¥—Å—Ç—Ä–æ–∫–æ–π (–≤ DEMO: `customer_phone`, `order_id`, `customer_id`, case-insensitive)
- `status?: str` ‚Äî —Ç–æ—á–Ω—ã–π –º–∞—Ç—á –ø–æ `status`
- `preset?: "stuck" | "late_ship" | "payment_issues"`
- `flagged?: bool`
- `limit: int` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `20`, –¥–∏–∞–ø–∞–∑–æ–Ω `1..200`)

–ü—Ä–µ—Å–µ—Ç—ã (DEMO defaults):
- `stuck`: `status == "stuck"` **–∏–ª–∏** `payment_status in ("pending", null)` –∏ –∑–∞–∫–∞–∑ —Å—Ç–∞—Ä—à–µ `6h`.
- `late_ship`: `payment_status == "paid"` –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, `ship_due_at < now`.
- `payment_issues`: `payment_status == "failed"` **–∏–ª–∏** `payment_status == "pending"` –∏ –∑–∞–∫–∞–∑ —Å—Ç–∞—Ä—à–µ `2h`.

> –í —Ä–µ–∂–∏–º–∞—Ö `SIS_HTTP`/`AUTO` Orders tools –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ SIS Actions API (–±—É–¥–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π PR –≤ SIS).

### –î–µ–π—Å—Ç–≤–∏—è

* **ORD_FLAG** ‚Äî –ü–æ–º–µ—Ç–∏—Ç—å –∑–∞–∫–∞–∑ (–ø—Ä–∏—á–∏–Ω–∞)
* **ORD_NOTIFY_TEAM** ‚Äî –ù–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É –ø–æ –∑–∞–∫–∞–∑—É

  * Tools: `flag_order`, `notify_team`
  * Confirm: –¥–ª—è notify_team –Ω–µ—Ç, –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–∞

### –ú–∞—Å—Å–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–µ—Å–ª–∏ –±—É–¥—É—Ç)

* **ORD_BULK_FLAG** ‚Äî –ú–∞—Å—Å–æ–≤–æ –ø–æ–º–µ—Ç–∏—Ç—å (–ø–æ —Ñ–∏–ª—å—Ç—Ä—É)

  * Confirm: –¥–∞ (dry_run ‚Üí confirm)

---

## üí∏ –¶–µ–Ω—ã (FX)

*(FX —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ SIS –∏ OwnerBot. –ó–¥–µ—Å—å ‚Äî –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤ –≤–æ–∫—Ä—É–≥ –Ω–µ–≥–æ.)*

### –°—Ç–∞—Ç—É—Å –∏ –∫—É—Ä—Å

* **FX_STATUS** ‚Äî FX —Å—Ç–∞—Ç—É—Å (—Ä–µ–∂–∏–º/–ø–æ—Ä–æ–≥–∏/–∫—É–ª–¥–∞—É–Ω/–ø–æ—Å–ª–µ–¥–Ω–∏–π apply)

  * Tools: `sis_fx_status`
  * Confirm: –Ω–µ—Ç

* **FX_PREVIEW** ‚Äî –ù—É–∂–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ü–µ–Ω—ã —Å–µ–π—á–∞—Å?

  * Tools: `sis_fx_reprice_auto(dry_run=True)`
  * Confirm: –Ω–µ—Ç

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

* **FX_APPLY_IF_NEEDED** ‚Äî –û–±–Ω–æ–≤–∏ —Ü–µ–Ω—ã (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–∞–¥–æ)

  * Flow: preview ‚Üí –µ—Å–ª–∏ would_apply=true ‚Üí confirm ‚Üí apply
  * Tools: `sis_fx_reprice_auto(dry_run=True)` ‚Üí `sis_fx_reprice_auto(dry_run=False)`
  * Confirm: –¥–∞ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ noop)

* **FX_FORCE_APPLY** ‚Äî –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏ —Ü–µ–Ω—ã

  * Flow: preview ‚Üí confirm(force) ‚Üí apply(force)
  * Tools: `sis_fx_reprice_auto(force=True)`
  * Confirm: –¥–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ FX

* **FX_SETTINGS_VIEW** ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å FX –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
* **FX_SETTINGS_SET_SCHEDULE** ‚Äî –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (manual/daily/interval)
* **FX_SETTINGS_SET_THRESHOLDS** ‚Äî –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥–∏ (abs/% + cooldown)
* **FX_SETTINGS_SET_NOTIFY** ‚Äî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è FX (on/off)

  * Tools: `sis_fx_settings_update(dry_run=True/False)`
  * Confirm: –¥–∞ (–µ—Å–ª–∏ –º–µ–Ω—è–µ–º)

---

## üè∑Ô∏è –°–∫–∏–¥–∫–∏

### –û–±–∑–æ—Ä

* **DSC_STATUS** ‚Äî –°–≤–æ–¥–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–∫–∏–¥–æ–∫/–∫—É–ø–æ–Ω–æ–≤
* **DSC_TOP_USED** ‚Äî –¢–æ–ø –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫—É–ø–æ–Ω–æ–≤

### –°–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è SIS)

* **DSC_CREATE_COUPON** ‚Äî –°–æ–∑–¥–∞—Ç—å –∫—É–ø–æ–Ω
* **DSC_DISABLE_COUPON** ‚Äî –û—Ç–∫–ª—é—á–∏—Ç—å –∫—É–ø–æ–Ω
* **DSC_BULK_DISABLE** ‚Äî –û—Ç–∫–ª—é—á–∏—Ç—å –ø–∞—á–∫—É –∫—É–ø–æ–Ω–æ–≤ –ø–æ –ø—Ä–∞–≤–∏–ª—É

  * Confirm: –¥–∞ (dry_run ‚Üí confirm)

---

## üì¶ –¢–æ–≤–∞—Ä—ã

### –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

* **PRD_NO_PHOTO** ‚Äî –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ñ–æ—Ç–æ
* **PRD_NO_VIDEO** ‚Äî –¢–æ–≤–∞—Ä—ã –±–µ–∑ –≤–∏–¥–µ–æ
* **PRD_NO_PRICE** ‚Äî –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ü–µ–Ω—ã
* **PRD_LOW_STOCK** ‚Äî –ù–∏–∑–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏
* **PRD_INVENTORY_STATUS** ‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ (–æ—Å—Ç–∞—Ç–∫–∏/—Ñ–æ—Ç–æ/—Ü–µ–Ω—ã/–ø—É–±–ª–∏–∫–∞—Ü–∏—è)

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤

* **PRD_SALES_RANK_30D** ‚Äî –†–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–¥–∞–∂ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
* **PRD_RETURN_FLAGS** ‚Äî –¢–æ–≤–∞—Ä—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –º–µ—Ç–∫–∏)

### –î–µ–π—Å—Ç–≤–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å API)

* **PRD_DISABLE** ‚Äî –°–∫—Ä—ã—Ç—å —Ç–æ–≤–∞—Ä
* **PRD_UPDATE_PRICE** ‚Äî –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É (—Ç–æ—á–µ—á–Ω–æ)

  * Confirm: –¥–∞

---

## üë• –ö–æ–º–∞–Ω–¥–∞

### –ß–∞—Ç—ã –∏ –Ω–∞–≥—Ä—É–∑–∫–∞

* **TEAM_UNANSWERED_2H** ‚Äî –ß–∞—Ç—ã –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ > 2—á
* **TEAM_UNANSWERED_6H** ‚Äî –ß–∞—Ç—ã –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ > 6—á
* **TEAM_QUEUE_SUMMARY** ‚Äî –û—á–µ—Ä–µ–¥—å –æ–±—Ä–∞—â–µ–Ω–∏–π

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

* **TEAM_PING_MANAGER** ‚Äî –ù–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É
* **TEAM_BROADCAST** ‚Äî –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–µ (–º–∞—Å—Å–æ–≤–æ–µ)

  * Confirm: –¥–∞

---

## ‚öôÔ∏è –°–∏—Å—Ç–µ–º—ã

### –ó–¥–æ—Ä–æ–≤—å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

* **SYS_HEALTH** ‚Äî –°—Ç–∞—Ç—É—Å –∞–ø—Å—Ç—Ä–∏–º–æ–≤ (SIS, FX provider)
* **SYS_LAST_ERRORS** ‚Äî –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏/–≤arnings

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

* **SYS_UPSTREAM_MODE** ‚Äî –ö–∞–∫–æ–π —Ä–µ–∂–∏–º –∞–ø—Å—Ç—Ä–∏–º–∞ —Å–µ–π—á–∞—Å (demo/live)
* **SYS_AUDIT_RECENT** ‚Äî –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (audit)

---

## üîß Advanced

* **ADV_RAW_TOOL_CALL** ‚Äî –í—ã–ø–æ–ª–Ω–∏—Ç—å tool-call –≤—Ä—É—á–Ω—É—é (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
* **ADV_EXPORT_JSON** ‚Äî –≠–∫—Å–ø–æ—Ä—Ç —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç—á—ë—Ç–∞ (json)
* **ADV_REPLAY_LAST** ‚Äî –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ (—Å idempotency)

---

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

*(–≠—Ç–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–∞—è ‚Äú–º–∞–≥–∏—è‚Äù: –≤–ª–∞–¥–µ–ª–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç —Å–∏–≥–Ω–∞–ª, –∞ –Ω–µ –ª–µ–∑–µ—Ç –≤ –∫–Ω–æ–ø–∫–∏.)*

### –ü–æ–¥–ø–∏—Å–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞

* **NTF_STATUS** ‚Äî –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–æ–∫/–Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
* **NTF_FX_DELTA_SUBSCRIBE** ‚Äî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É—Ä—Å–∞ (–ø–æ—Ä–æ–≥/–∫—É–ª–¥–∞—É–Ω)
* **NTF_FX_DELTA_UNSUBSCRIBE** ‚Äî –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç FX
* **NTF_FX_APPLY_EVENTS_SUBSCRIBE** ‚Äî –í–∫–ª—é—á–∏—Ç—å FX apply events (applied/noop/failed + cooldown)
* **NTF_FX_APPLY_EVENTS_UNSUBSCRIBE** ‚Äî –í—ã–∫–ª—é—á–∏—Ç—å FX apply events
* **NTF_DAILY_DIGEST_SUBSCRIBE** ‚Äî –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç (–≤—Ä–µ–º—è)
* **NTF_DAILY_DIGEST_UNSUBSCRIBE** ‚Äî –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –¥–∞–π–¥–∂–µ—Å—Ç–∞
* **NTF_DIGEST_FORMAT_SET** ‚Äî –§–æ—Ä–º–∞—Ç daily digest (`text|png|pdf`)
* **NTF_WEEKLY_SUBSCRIBE** ‚Äî –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ weekly PDF (–¥–µ–Ω—å/–≤—Ä–µ–º—è/tz)
* **NTF_WEEKLY_UNSUBSCRIBE** ‚Äî –í—ã–∫–ª—é—á–∏—Ç—å weekly PDF
* **NTF_OPS_ALERTS_SUBSCRIBE** ‚Äî –í–∫–ª—é—á–∏—Ç—å ops alerts (–ø–æ—Ä–æ–≥–∏ + cooldown + dedupe)
* **NTF_OPS_ALERTS_UNSUBSCRIBE** ‚Äî –í—ã–∫–ª—é—á–∏—Ç—å ops alerts

### –†–∞–∑–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

* **NTF_SEND_DIGEST_NOW** ‚Äî –ü—Ä–∏—Å–ª–∞—Ç—å digest —Å–µ–π—á–∞—Å (debug/–ø—Ä–æ–≤–µ—Ä–∫–∞)
* **NTF_SEND_WEEKLY_NOW** ‚Äî –ü—Ä–∏—Å–ª–∞—Ç—å weekly PDF —Å–µ–π—á–∞—Å

---

# –ì–¥–µ –∂–∏–≤—É—Ç —à–∞–±–ª–æ–Ω—ã –∏ –∫–∞–∫ –∏—Ö –±—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–ª—è—Ç—å (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ –¥–æ–ª–∂–Ω–æ –∑–∞–Ω–∏–º–∞—Ç—å **5‚Äì10 –º–∏–Ω—É—Ç**:

1. –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
2. (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–æ–±–∞–≤–∏—Ç—å/–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tool
3. —à–∞–±–ª–æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –º–µ–Ω—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1) –ö–∞—Ç–∞–ª–æ–≥ —à–∞–±–ª–æ–Ω–æ–≤ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –∫–∞–∫ –∫–æ–¥ —Ä–æ—É—Ç–µ—Ä–∞)

–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å:

* `app/templates/catalog/`

  * `__init__.py`
  * `models.py` (TemplateSpec)
  * `loaders.py` (YAML/JSON loader)
  * `catalog.py` (registry + helpers)
  * `defs/*.yml` (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤)

TemplateSpec –ø–æ–ª—è:

* `id: str`
* `category: str`
* `title: str`
* `button: str` (—Ç–µ–∫—Å—Ç –Ω–∞ –∫–Ω–æ–ø–∫–µ)
* `intent_aliases: list[str]`
* `kind: read|action`
* `tool: str` (tool id)
* `payload_factory: str|dict` (preset payload)
* `confirm_policy: none|if_needed|always`
* `render: text|table|png|pdf`
* `order: int` (—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)

### 2) –ú–µ–Ω—é —Å—Ç—Ä–æ–∏–º –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞

`templates_keyboards.py` –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –≤—Å–µ –∫–Ω–æ–ø–∫–∏.
–û–Ω –¥–æ–ª–∂–µ–Ω:

* –±—Ä–∞—Ç—å —Å–ø–∏—Å–æ–∫ `TemplateSpec` –ø–æ category
* —Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤ 2 –∫–æ–ª–æ–Ω–∫–∏
* –¥–æ–±–∞–≤–ª—è—Ç—å ‚Äú–ï—â—ë‚Ä¶‚Äù –µ—Å–ª–∏ > 8

### 3) –†–æ—É—Ç–µ—Ä —à–∞–±–ª–æ–Ω–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π

`app/bot/routers/templates.py`:

* –µ–¥–∏–Ω—ã–π handler `handle_template(spec_id)`
* –ø–æ `TemplateSpec`:

  * —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å payload
  * –≤—ã–∑–≤–∞—Ç—å tool
  * –ø—Ä–∏–º–µ–Ω–∏—Ç—å confirm_policy
  * –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å output_renderer

### 4) –ë—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω

* –¥–æ–±–∞–≤–ª—è–µ—à—å `app/templates/catalog/defs/RPT_REVENUE_TREND_30D_PNG.yml`
* —É–∫–∞–∑—ã–≤–∞–µ—à—å tool `revenue_trend` + render=png
* –≤—Å—ë. –ú–µ–Ω—é –∏ —Ä–æ—É—Ç–µ—Ä –µ–≥–æ –ø–æ–¥—Ö–≤–∞—Ç—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 5) –ï—Å–ª–∏ –Ω–∞–¥–æ –Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ

* —Å–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–ª—è–µ—à—å tool (–≤ `app/tools/impl/...`)
* –∑–∞—Ç–µ–º —à–∞–±–ª–æ–Ω YAML, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –≤—ã–∑—ã–≤–∞–µ—Ç


## Template engine

### –ì–¥–µ –ª–µ–∂–∞—Ç defs
- `app/templates/defs/*.yml` ‚Äî source-of-truth —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è `/templates`.
- `app/templates/catalog/models.py` ‚Äî `TemplateSpec`/`InputStep` –º–æ–¥–µ–ª—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è.
- `app/templates/catalog/loader.py` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ defs –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ duplicate `template_id`.

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω
1. –°–æ–∑–¥–∞–π `*.yml` –≤ `app/templates/defs/` —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º `template_id`.
2. –£–∫–∞–∂–∏ `category`, `button_text`, `kind`, `tool_name`, `default_payload`, `inputs`.
3. –ï—Å–ª–∏ –Ω—É–∂–Ω—ã —à–∞–≥–∏ –≤–≤–æ–¥–∞ ‚Äî –¥–æ–±–∞–≤—å `inputs[]` —Å `parser` –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `presets`.
4. –ù–∏—á–µ–≥–æ –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é –≤ keyboard/router: –º–µ–Ω—é –∏ –∑–∞–ø—É—Å–∫ —Å—Ç—Ä–æ—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞.

### –ü—Ä–∞–≤–∏–ª–∞
- `template_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º; –¥—É–±–ª–∏–∫–∞—Ç—ã = –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ.
- `category` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –≤ –º–µ–Ω—é `/templates`.
- `inputs` –∑–∞–¥–∞—é—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π flow: —à–∞–≥–∏, –ø–∞—Ä—Å–µ—Ä—ã, –∫–Ω–æ–ø–æ—á–Ω—ã–µ presets.
- –î–ª—è `kind=ACTION` –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è preview (`dry_run`) –ø–µ—Ä–µ–¥ confirm/commit —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ACTION pipeline.

---

# –ó–∞–º–µ–Ω–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–§–∞–π–ª `docs/OWNERBOT_TEMPLATES.md` —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º, –µ—Å–ª–∏:

* —Ç–∞–º –Ω–µ—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ `TemplateSpec` –∫–∞–∫ –¥–∞–Ω–Ω—ã—Ö
* –∫–Ω–æ–ø–∫–∏/—à–∞–±–ª–æ–Ω—ã –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Ä—É—á–Ω—É—é

–†–µ—à–µ–Ω–∏–µ:

* –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –≤ `docs/OWNERBOT_TEMPLATES_LEGACY.md`
* –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π `docs/OWNERBOT_TEMPLATES.md` –Ω–∞ –±–∞–∑–µ —ç—Ç–æ–≥–æ V2
* –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é ‚Äú–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω –∑–∞ 10 –º–∏–Ω—É—Ç‚Äù

---

# Forecast templates (implemented, DEMO-only)

–ü—Ä–æ–≥–Ω–æ–∑—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ read-only —Å–ª–æ–π –≤ DEMO —Ä–µ–∂–∏–º–µ.

- **FRC_7D_DEMAND** (`demand_forecast`)
  - –ß—Ç–æ –¥–µ–ª–∞–µ—Ç: —Å—á–∏—Ç–∞–µ—Ç —Å—Ä–µ–¥–Ω–∏–π –¥–Ω–µ–≤–Ω–æ–π —Å–ø—Ä–æ—Å –ø–æ paid –ø—Ä–æ–¥–∞–∂–∞–º –∑–∞ –∏—Å—Ç–æ—Ä–∏—é –∏ –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 7 –¥–Ω–µ–π.
  - Inputs: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∑ —à–∞–≥–æ–≤ (one-tap); –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å tool —Å `method`, `history_days`, `include_categories`.
  - Output fields: `avg_daily_qty`, `forecast_daily_qty`, `forecast_total_qty`, `nonzero_days`, `confidence`, `notes[]`.

- **FRC_REORDER_PLAN** (`reorder_plan`)
  - –ß—Ç–æ –¥–µ–ª–∞–µ—Ç: —Å—Ç—Ä–æ–∏—Ç reorder point –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é –¥–æ–∑–∞–∫—É–ø–∫—É –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ.
  - Inputs: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∑ —à–∞–≥–æ–≤ (one-tap); –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `lead_time_days`, `safety_stock_days` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ tool payload.
  - Output fields: `forecast_daily_qty`, `reorder_point`, `recommended_order_qty`, `stock_cover_days`, `confidence`, `notes[]`.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –ø—Ä–∏ `UPSTREAM_MODE != DEMO` –æ–±–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `UPSTREAM_NOT_IMPLEMENTED` –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è SIS sales aggregates endpoint.

Voice phrases:
- ¬´–ø—Ä–æ–≥–Ω–æ–∑ —Å–ø—Ä–æ—Å–∞¬ª, ¬´–ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 7 –¥–Ω–µ–π¬ª, ¬´—á—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å—Å—è¬ª ‚Üí `demand_forecast`
- ¬´–ø–ª–∞–Ω –∑–∞–∫—É–ø–∫–∏¬ª, ¬´–ø–ª–∞–Ω –¥–æ–∑–∞–∫—É–ø–∫–∏¬ª, ¬´—á—Ç–æ –¥–æ–∫—É–ø–∏—Ç—å¬ª ‚Üí `reorder_plan`


- `notifications_ntf_quiet_digest_on.yml` ‚Äî –∫–Ω–æ–ø–∫–∞ `Quiet Digest ON` (`ntf_quiet_digest_on`).
- `notifications_ntf_quiet_digest_off.yml` ‚Äî –∫–Ω–æ–ø–∫–∞ `Quiet Digest OFF` (`ntf_quiet_digest_off`).
- `notifications_ntf_quiet_digest_rules_set.yml` ‚Äî –∫–Ω–æ–ø–∫–∞ `Quiet Digest rules` (`ntf_quiet_digest_rules_set`).
